<!DOCTYPE html>
<html>

<head>
  <script src="static/jquery_3.2.1.min.js"></script>
  <script>
  "use strict";
  const STREAM_CTL_URL = 'http://172.24.1.1:5000/start_stream';
  const MOTOR_CTL_URL = 'http://172.24.1.1:5000/move';
  const STREAM_URL = 'http://172.24.1.1:8080/?action=stream';

  function start_stream(width=1280, height=720, fps=10, sharpness=0, contrast=0, brightness=50, saturation=0) {
    $.ajax({
      url: STREAM_CTL_URL,
      data: {
        width: width,
        height: height,
        fps: fps,
        sharpness: sharpness,
        contrast: contrast,
        brightness: brightness,
        saturation: saturation,
      },
      success: function(){
        load_stream();
      },
      error: function(){
        alert('Could not restart stream with new parameters');
      }
    });
  }

  function load_stream(width=1280, height=720, fps=10){
    $('#stream_container').empty()
      .append(`<img id="stream" width="${width}" height="${height}" src="${STREAM_URL}" />`);
  }

  function move(x=0, y=0 , z=0){
    $.ajax({
      url: WS_MOTOR_CTL_URL,
      data: {
        x: x,
        y: y,
        z: z,
      },
      error: function(){
        alert('Error when attempting to move motors');
      }
    })
  }

  // Execute this when document has loaded
  $(load_stream);
  </script>
  <title>WaterScope</title>
</head>

<body>
  <div id="stream_container">
  </div>
</body>

</html>
